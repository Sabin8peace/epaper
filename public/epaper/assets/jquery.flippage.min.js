(function($){$.flippage={};$.flippage.options={width:200,height:150,shadowSize:12,delay:250,selectable:false};$.fn.flippage=function(o){var p=$.extend({},$.flippage.options,o);p.width=p.width/2;return this.each(function(){var h=$(this);var i={};h.addClass('flippage').css({width:p.width*2,height:p.height}).children('div:not(.flippage_page)').each(function(){h.append($('<div></div>').addClass('flippage_page').css({width:p.width,height:p.height}).append($(this).css({width:p.width,height:p.height})))});var j=0;var k=false;var l=false;var m=false;h.bind('previous',function(a){h.children('div').eq(j).trigger('mousedown',[true]);h.delay(p.delay).queue(function(){$(document).trigger('mouseup',[true]);h.dequeue()},'delayflip')});h.bind('next',function(a){h.children('div').eq(j+1).trigger('mousedown',[true]);h.delay(p.delay).queue(function(){$(document).trigger('mouseup',[true]);h.dequeue()},'delayflip')});var n=function(g){k=false;l=false;if(g<0||g>h.find('div').size()-1){return}j=g;h.find('div').css('-moz-transition','none').css('-webkit-transition','none').css('-o-transition','none').css('-ms-transition','none').css('transition','none');h.find('div > div').css('-moz-transition','none').css('-webkit-transition','none').css('-o-transition','none').css('-ms-transition','none').css('transition','none').css('margin-left','0px');h.find('.flippage_rshadow').remove();h.find('.flippage_lshadow').remove();h.children('div:lt('+(j)+')').hide();h.children('div').unbind('mousedown');h.children('div:gt('+(j+1)+')').hide();h.children('div').eq(j).css({left:0});h.children('div').eq(j+1).css({left:p.width});if(h.children('div').eq(j+2).size()>0){h.children('div').eq(j+1).bind('mousedown',function(e,f){m=true;h.delay(p.delay).queue(function(){h.clearQueue('delayflip');if(m&&!l&&!k){var a=h.children('div').eq(j);var b=h.children('div').eq(j+1);var c=h.children('div').eq(j+2);var d=h.children('div').eq(j+3);h.addClass('flippage_flipping');if(!f){i.left=e.pageX-(typeof(e.layerX)=="undefined"?e.originalEvent.layerX:e.layerX)-p.width}else{i.left=0}a.css({zIndex:1,left:0});b.css({zIndex:3,left:p.width});c.css({zIndex:4,left:p.width*2,width:0,webkitBoxShadow:'-'+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)',mozBoxShadow:'-'+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)',oBoxShadow:'-'+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)',msBoxShadow:'-'+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)',boxShadow:'-'+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)'}).append($('<div></div>').addClass('flippage_rshadow').css({width:p.width,height:p.height,opacity:1,right:0}));d.css({zIndex:2,left:p.width,width:p.width});k=true;c.show();d.show()}h.dequeue()},'delayflip');if(!p.selectable){return false}})}if(j>0){h.children('div').eq(j).bind('mousedown',function(e,f){m=true;h.delay(p.delay).queue(function(){h.clearQueue('delayflip');if(m&&!k&&!l){var a=h.children('div').eq(j+1);var b=h.children('div').eq(j);var c=h.children('div').eq(j-1);var d=h.children('div').eq(j-2);h.addClass('flippage_flipping');if(!f){i.left=e.pageX-(typeof(e.layerX)=="undefined"?e.originalEvent.layerX:e.layerX)}else{i.left=0}a.css({zIndex:1,left:p.width});b.show().css({zIndex:3,left:0,width:p.width}).children('div:eq(0)').css({marginLeft:0});c.css({zIndex:4,left:0,width:0,webkitBoxShadow:''+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)',mozBoxShadow:''+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)',oBoxShadow:''+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)',msBoxShadow:''+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)',boxShadow:''+p.shadowSize+'px 0px '+p.shadowSize+'px rgb(170, 170, 170)'}).append($('<div></div>').addClass('flippage_lshadow').css({width:p.width,height:p.height,opacity:1,right:-1*p.width})).children('div:eq(0)').css({marginLeft:p.height*-1});d.css({zIndex:2,left:0,width:p.width});l=true;c.show();d.show()}h.dequeue()},'delayflip');if(!p.selectable){return false}})}};n(0);$(document).bind('mousemove',function(a){if(k){var b=h.children('div').eq(j+1);var c=h.children('div').eq(j+2);if(a.pageX<i.left){b.hide().css({width:0});c.css({left:0,width:p.width,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'})}else if(a.pageX-i.left<p.width){var d=(((a.pageX-i.left)/(p.width*2)))*p.shadowSize;b.hide().css({width:0});c.css({left:a.pageX-i.left,width:p.width-((a.pageX-i.left)/2),webkitBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',mozBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',oBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',msBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',boxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)'})}else if(a.pageX-i.left>p.width*2){b.show().css({width:p.width});c.css({left:p.width*2,width:0,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'})}else{var d=(1-((p.width*2-(a.pageX-i.left)))/(p.width*2))*p.shadowSize;b.show().css({width:a.pageX-i.left-p.width});c.css({left:a.pageX-i.left,width:p.width-(a.pageX-i.left)/2,webkitBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',mozBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',oBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',msBoxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)',boxShadow:'-'+d+'px 0px '+d+'px rgb(170, 170, 170)'})}c.children('.flippage_rshadow').css({opacity:1-(c.width()/p.width)})}else if(l){var b=h.children('div').eq(j);var c=h.children('div').eq(j-1);if(a.pageX-i.left>p.width&&a.pageX-i.left<p.width*2){var d=((p.width*2-(a.pageX-i.left))/p.width)*p.shadowSize;b.hide().css({width:0,left:p.width}).children('div:eq(0)').css({marginLeft:p.width*-1});c.css({left:(a.pageX-i.left)/2,width:(a.pageX-i.left)/2,webkitBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',mozBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',oBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',msBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',boxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)'}).children('div:eq(0)').css({marginLeft:(a.pageX-i.left)/2-p.width})}else if(a.pageX-i.left>=p.width*2){b.hide().css({width:0,left:p.width}).children('div:eq(0)').css({marginLeft:p.width*-1});c.css({left:p.width,width:p.width,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'}).children('div:eq(0)').css({marginLeft:0})}else if(a.pageX<=i.left){b.show().css({width:p.width,left:0}).children('div:eq(0)').css({marginLeft:0});c.css({left:0,width:0,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'}).children('div:eq(0)').css({marginLeft:-1*p.width})}else{var d=(1-((a.pageX-i.left)/(p.width*2)))*p.shadowSize;b.show().css({width:p.width-(a.pageX-i.left),left:a.pageX-i.left}).children('div:eq(0)').css({marginLeft:(a.pageX-i.left)*-1});c.css({left:(a.pageX-i.left)/2,width:(a.pageX-i.left)/2,webkitBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',mozBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',oBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',msBoxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)',boxShadow:''+d+'px 0px '+d+'px rgb(170, 170, 170)'}).children('div:eq(0)').css({marginLeft:(a.pageX-i.left)/2-p.width})}c.children('.flippage_lshadow').css({right:c.width()-p.width,opacity:1-(c.width()/p.width)})}}).bind('mouseup',function(a,b){m=false;if(k){var c=h.children('div').eq(j+1);var d=h.children('div').eq(j+2);h.removeClass('flippage_flipping');d.css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({left:0,width:p.width,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'}).children('.flippage_rshadow').css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({opacity:0,right:(p.width)*-1});c.css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({width:0});k=false;setTimeout(function(){n(j+2)},500)}else if(l){var c=h.children('div').eq(j);var d=h.children('div').eq(j-1);h.removeClass('flippage_flipping');d.css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({left:p.width,width:p.width,webkitBoxShadow:'none',mozBoxShadow:'none',oBoxShadow:'none',msBoxShadow:'none',boxShadow:'none'}).children('.flippage_lshadow').css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({opacity:0,right:0});d.children('div:eq(0)').css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({marginLeft:0});c.css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({width:0,left:p.width}).children('div:eq(0)').css('-moz-transition','all 0.5s ease-in').css('-webkit-transition','all 0.5s ease-in').css('-o-transition','all 0.5s ease-in').css('-ms-transition','all 0.5s ease-in').css('transition','all 0.5s ease-in').css({marginLeft:p.width*-1});l=false;setTimeout(function(){n(j-2)},500)}})})};if(typeof(document.addEventListener)!=undefined){$(document).ready(function(){function touchHandler(a){var b=a.changedTouches,first=b[0],type="";switch(a.type){case"touchstart":type="mousedown";break;case"touchmove":type="mousemove";break;case"touchend":type="mouseup";break;default:return}var c=document.createEvent("MouseEvent");c.initMouseEvent(type,true,true,window,1,first.screenX,first.screenY,first.clientX,first.clientY,false,false,false,false,0,null);first.target.dispatchEvent(c);if($('.flippage_flipping').size()>0){a.preventDefault()}}document.addEventListener("touchstart",touchHandler,true);document.addEventListener("touchmove",touchHandler,true);document.addEventListener("touchend",touchHandler,true);document.addEventListener("touchcancel",touchHandler,true)})}})(jQuery);